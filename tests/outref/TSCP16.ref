
SELECT ALL nullnamesb.id, alias3.* FROM nullnamesb  RIGHT JOIN (SELECT ALL alias1.yearsTenured, alias1.firstName FROM nullnames alias1 ORDER BY alias1.firstName, alias1.yearsTenured) AS alias1 ON ((nullnamesb.yearsTenured <= alias1.yearsTenured) OR (nullnamesb.id = alias1.yearsTenured)) LEFT JOIN (SELECT DISTINCT alias3.lastName FROM nullnamesb alias3 ORDER BY alias3.lastName) AS alias3 ON (((nullnamesb.lastName != alias3.lastName)) OR NOT (nullnamesb.salary <= ANY (SELECT DISTINCT alias4.salary FROM nullnames alias4 ORDER BY alias4.salary LIMIT 1))) WHERE nullnamesb.exempt = FALSE ORDER BY alias3.*, nullnamesb.id;
ID|LASTNAME
1|Burn
1|Burn
1|Burn
3|Burn
3|Burn
3|Burn
3|Burn
5|Burn
1|Cool
1|Cool
1|Cool
3|Cool
3|Cool
3|Cool
3|Cool
5|Cool
1|Killer
1|Killer
1|Killer
3|Killer
3|Killer
3|Killer
3|Killer
5|Killer
1|Nikon
1|Nikon
1|Nikon
3|Nikon
3|Nikon
3|Nikon
3|Nikon
5|Nikon
1|
1|
1|
3|
3|
3|
3|
4|
4|
4|
4|
5|
(44 rows)
